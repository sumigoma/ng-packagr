{"version":3,"file":"package.js","sourceRoot":"","sources":["../../../src/lib/steps/package.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,uCAAsC;AACtC,6BAA6B;AAC7B,mCAAmC;AAGnC;;;;;;;;;;;;;;GAcG;AACH,sBAAmC,UAAwB,EAAE,QAAmC;;QAE9F,GAAG,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;QAC1B,MAAM,WAAW,GAAQ,UAAU,CAAC,WAAW,CAAC;QAChD,4BAA4B;QAC5B,GAAG,CAAC,CAAC,MAAM,SAAS,IAAI,QAAQ,CAAC,CAAC,CAAC;YACjC,WAAW,CAAC,SAAS,CAAC,GAAG,QAAQ,CAAC,SAAS,CAAC,CAAC;QAC/C,CAAC;QAED,WAAW,CAAC,IAAI,GAAG,UAAU,CAAC,QAAQ,CAAC;QAEvC,mCAAmC;QACnC,wDAAwD;QACxD,OAAO,WAAW,CAAC,SAAS,CAAC;QAE7B,wEAAwE;QACxE,kFAAkF;QAClF,MAAM,qBAAU,CACd,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,eAAe,EAAE,cAAc,CAAC,EACxD,WAAW,EACX,EAAE,MAAM,EAAE,CAAC,EAAE,CACd,CAAC;IACJ,CAAC;CAAA;AAtBD,oCAsBC","sourcesContent":["import { outputJson } from 'fs-extra';\nimport * as path from 'path';\nimport * as log from '../util/log';\nimport { NgEntryPoint } from '../ng-package-format/entry-point';\n\n/**\n * Creates and writes a `package.json` file of the entry point used by the `node_module`\n * resolution strategies.\n *\n * #### Example\n *\n * A consumer of the enty point depends on it by `import {..} from '@my/module/id';`.\n * The module id `@my/module/id` will be resolved to the `package.json` file that is written by\n * this build step.\n * The proprties `main`, `module`, `typings` (and so on) in the `package.json` point to the\n * flattened JavaScript bundles, type definitions, (...).\n *\n * @param entryPoint An entry point of an Angular package / library\n * @param binaries Binary artefacts (bundle files) to merge into `package.json`\n */\nexport async function writePackage(entryPoint: NgEntryPoint, binaries: { [key: string]: string }): Promise<void> {\n\n  log.debug('writePackage');\n  const packageJson: any = entryPoint.packageJson;\n  // set additional properties\n  for (const fieldName in binaries) {\n    packageJson[fieldName] = binaries[fieldName];\n  }\n\n  packageJson.name = entryPoint.moduleId;\n\n  // keep the dist package.json clean\n  // this will not throw if ngPackage field does not exist\n  delete packageJson.ngPackage;\n\n  // `outputJson()` creates intermediate directories, if they do not exist\n  // -- https://github.com/jprichardson/node-fs-extra/blob/master/docs/outputJson.md\n  await outputJson(\n    path.resolve(entryPoint.destinationPath, 'package.json'),\n    packageJson,\n    { spaces: 2 }\n  );\n}\n"]}